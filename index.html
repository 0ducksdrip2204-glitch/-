<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>분복매 (분할 복리 매매 시뮬레이터)</title>
  <style>
    body {
      text-align: center;
      font-family: Arial, sans-serif;
      background-color: #fdfdfd;
      color: #333;
      padding: 20px;
    }

    h2 {
      margin-bottom: 20px;
      color: #2c3e50;
    }

    label {
      display: block;
      margin: 10px 0;
      font-size: 16px;
    }

    input {
      padding: 6px 10px;
      font-size: 16px;
      text-align: left; /* 왼쪽 정렬 */
      width: 120px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .unit {
      font-size: 16px;
      margin-left: 5px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 15px 0;
      border: none;
      border-radius: 5px;
      background-color: #27ae60;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #2ecc71;
    }

    /* 아래 표 (횟수별 상세 표) 작게 */
    table#result-table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 90%;
      max-width: 700px;
      font-size: 14px; /* 글자 작게 */
    }

    table#result-table th, table#result-table td {
      border: 1px solid #ccc;
      padding: 6px; /* 패딩 줄임 */
      text-align: right;
    }

    table#result-table th {
      background-color: #3498db;
      color: white;
    }

    table#result-table tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    .profit {
      color: green; /* 수익 초록색 */
    }

    #summary {
      margin: 20px auto;
      width: 90%;
      max-width: 500px;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
      background-color: #f9f9f9;
      text-align: center;
      font-size: 16px;
    }

    #summary .total-profit {
      color: green; /* 최종 수익 초록색 */
      font-weight: bold;
      margin-right: 15px;
    }

    #summary .total-capital {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>분복매 - 분할 복리 매매 시뮬레이터</h2>

  <label>원금:
    <input type="text" id="capital" value="5,000,000" oninput="formatCapital()" onkeydown="handleEnter(event)">
    <span class="unit">원</span>
  </label>

  <label>분할 (예: 5 = 1/5):
    <input type="number" id="fraction" value="5" onkeydown="handleEnter(event)">
  </label>

  <label>수익률 (%):
    <input type="number" id="rate" value="10" onkeydown="handleEnter(event)">
  </label>

  <label>매매 횟수:
    <input type="number" id="trades" value="30" onkeydown="handleEnter(event)">
  </label>

  <button onclick="calculate()">계산하기</button>

  <!-- 최종 요약 -->
  <div id="summary"></div>

  <div id="result"></div>

  <script>
    // 원금 입력 자동 천 단위 포맷
    function formatCapital() {
      let input = document.getElementById('capital');
      let num = input.value.replace(/[^0-9]/g, '');
      if(num !== '') {
        num = parseInt(num).toLocaleString();
      }
      input.value = num;
    }

    // 엔터 키 입력 시 계산
    function handleEnter(event) {
      if (event.key === "Enter") {
        calculate();
      }
    }

    // 계산 함수
    function calculate() {
      let capitalInput = document.getElementById('capital').value.replace(/,/g, '');
      let capital = parseFloat(capitalInput);

      let fraction = parseFloat(document.getElementById('fraction').value);
      let rate = parseFloat(document.getElementById('rate').value) / 100;
      let trades = parseInt(document.getElementById('trades').value);

      let totalProfit = 0; // 총 수익

      let html = '<table id="result-table"><tr><th>횟수</th><th>투자금</th><th>수익</th><th>총자산</th></tr>';

      for (let i = 1; i <= trades; i++) {
        let invest = capital / fraction;
        let profit = invest * rate;
        capital += profit;
        totalProfit += profit;

        html += `<tr>
                  <td>${i}</td>
                  <td>${Math.round(invest).toLocaleString()}원</td>
                  <td class="profit">+${Math.round(profit).toLocaleString()}원</td>
                  <td>${Math.round(capital).toLocaleString()}원</td>
                 </tr>`;
      }

      html += '</table>';

      // 최종 요약 표시
      document.getElementById('summary').innerHTML =
        `<span class="total-profit">최종 수익: +${Math.round(totalProfit).toLocaleString()}원</span>` +
        `<span class="total-capital">최종 자산: ${Math.round(capital).toLocaleString()}원</span>`;

      document.getElementById('result').innerHTML = html;
    }
  </script>
</body>
</html>
